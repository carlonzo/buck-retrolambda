# buck-retrolambda

This is a failed attempt into trying to add java 1.8 goodies to an Android project builded with Buck.

I used genrule() and a shell script that did the following steps.
1) unzip the content .jar file that was the output of the previous android_library() build step
2) run retrolambda on the .class files that were inside the .jar to convert their bytecode from java 1.8 to java 1.7
3) zip back the .class files inside the original .jar

This worked fine for the .java source files.
The problem is the R.java file.
The R.java file is not generated by Buck during the android_library build step.
The R.java file is generated during the android_binary build step.

The android_binary build step is one massive step and as far as I know there is no way to hook in some genrule build step after the generation of R.java and the Dex build step.

So the only possible way to use retrolambda with buck would be to modify the Buck (open) source code and add a new class RetrolambdaStep which should execute after the AaptStep (which generates R.java) and before the DxStep.

Right now I don't have enough time to compile and modify Buck to add such step.

